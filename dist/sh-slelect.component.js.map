{"version":3,"file":"sh-slelect.component.js","sourceRoot":"","sources":["../src/sh-slelect.component.ts"],"names":[],"mappings":"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","sourcesContent":["/**\r\n * Created by yonifarin on 12/3/16.\r\n */\r\nimport {\r\n    Component, OnInit, ElementRef, Input, forwardRef, ViewChild, Renderer, Output,\r\n    EventEmitter\r\n} from '@angular/core';\r\nimport {ControlValueAccessor, NG_VALUE_ACCESSOR} from \"@angular/forms\";\r\nimport {filter} from \"rxjs/operator/filter\";\r\n\r\n@ Component({\r\n    selector: 'sh-select',\r\n    template:`<div class=\"header\" [class.sh-select-disabled]=\"disabled\" [class.inline]=\"mode==='inline'\"\r\n     (click)=\"show()\" [class.open]=\"isOpen\">\r\n    <input type=\"text\"\r\n           #inputFilter\r\n           [hidden]=\"!isOpen\"\r\n           (click)=\"show()\"\r\n           [placeholder]=\"placeholder\"\r\n           [(ngModel)]=\"filter\"\r\n           (ngModelChange)=\"updateFilter($event)\">\r\n    <div (click)=\"show(); $event.stopPropagation()\"\r\n\r\n         *ngIf=\"!isOpen\">\r\n        {{selectedValues?.length ?\r\n        (isMultiselect ?\r\n        selectedValues?.length + ' Selected'\r\n        : (selectedValues[0].name || selectedValues))\r\n        : placeholder}}\r\n    </div>\r\n    <i class=\"close icon clear\"\r\n       *ngIf=\"showClear && selectedValues.length > 0\"\r\n       (click)=\"clear(); $event.stopPropagation()\"></i>\r\n</div>\r\n<sh-select-menu [isOpen]=\"isOpen\"\r\n                [rows]=\"rows\"\r\n                [selectedValues]=\"selectedValues\"\r\n                (noToggleClick)=\"toggleSelected($event)\"></sh-select-menu>`,\r\n    styles:[`:host{\r\n    display: block;\r\n    position: relative;\r\n    width: 100%;\r\n    padding: 0;\r\n    margin: 0;\r\n    font-family: 'RobotoDraft', 'Roboto', 'Helvetica Neue, Helvetica, Arial', sans-serif;\r\n    font-style: normal;\r\n    font-weight: 300;\r\n    font-size: 1.0rem;\r\n    line-height: 2rem;\r\n    letter-spacing: 0.01rem;\r\n    color: #212121;\r\n    -webkit-font-smoothing: antialiased;\r\n    -moz-osx-font-smoothing: grayscale;\r\n    text-rendering: optimizeLegibility;\r\n}\r\n\r\n.header{\r\n    width: 100%;\r\n    margin: 0 !important;\r\n    padding: 2px 30px 2px 10px;\r\n    box-sizing: border-box;\r\n    background-color: white;\r\n    font-size: 1.0em;\r\n    border-radius: 2px;\r\n    border: 1px solid rgba(34,36,38,.15);\r\n    vertical-align: middle;\r\n    cursor: pointer;\r\n}\r\n\r\n.header.inline{\r\n    background-color: transparent;\r\n    width: max-content;\r\n    border: none;\r\n}\r\n\r\n.header.open{\r\n    border-radius: 2px 2px 0 0;\r\n    box-shadow: 0 2px 3px 0 rgba(34,36,38,.15);\r\n    border-bottom: none;\r\n}\r\n\r\ndiv{\r\n    display: block;\r\n}\r\n\r\ninput[type=\"text\"]{\r\n    border: none !important;\r\n    vertical-align: middle !important;\r\n    width: 100%;\r\n    margin: 0 !important;\r\n    padding: 0px !important;\r\n    box-sizing: border-box;\r\n    background-color: white;\r\n    font-size: 1.0rem !important;\r\n    line-height: 2rem !important;\r\n    letter-spacing: 0.01rem !important;\r\n    font-family: 'RobotoDraft', 'Roboto', 'Helvetica Neue, Helvetica, Arial', sans-serif;\r\n    font-style: normal !important;\r\n    font-weight: 300 !important;\r\n    -webkit-font-smoothing: antialiased !important;\r\n    -moz-osx-font-smoothing: grayscale !important;;\r\n    text-rendering: optimizeLegibility !important;;\r\n}\r\n\r\ninput[type=\"text\"] { outline: none; }\r\n\r\n\r\n[hidden]{\r\n    display: none;\r\n}\r\n\r\ni.close.icon.clear::after {     \r\n    content: \"âœ•\";\r\n    padding-right: 8px;\r\n    font-weight: 800;\r\n    color: gray; \r\n}\r\n\r\ni.close.icon.clear:hover::after {\r\n    color: red; \r\n}\r\n\r\n.clear{\r\n    position: absolute;\r\n    right: 2px;\r\n    padding-left: 2px;\r\n    padding-right: 2px;\r\n    top:3px;\r\n    cursor: pointer;\r\n}\r\n.sh-select-disabled{\r\n    background-color: #e3e3e3;\r\n    color: darkgray;\r\n    cursor: not-allowed;\r\n}\r\n\r\n`],\r\n    host: {\r\n        '(window:mouseup)': 'onDocumentClick($event)'\r\n    },\r\n    providers: [\r\n        {\r\n            provide: NG_VALUE_ACCESSOR,\r\n            useExisting: ShSelectProvider(),\r\n            multi: true\r\n        }\r\n    ]\r\n})\r\nexport class ShSelectComponent implements ControlValueAccessor, OnInit {\r\n    @Input() placeholder:string = \"Type to filter\";\r\n    @Input() isMultiselect:boolean = false;\r\n    @Input() mode:\"default\" | \"inline\" = \"default\";\r\n    @Input() showClear:boolean = true;\r\n    @Input() disabled:boolean;\r\n    @ViewChild('inputFilter') inputFilter:ElementRef;\r\n    @Input() set options(val:any[]){\r\n        this._options = val;\r\n        this.updateRows(val);\r\n    }\r\n    get options():any[]{\r\n        return this._options;\r\n    }\r\n    @Output() onHide:EventEmitter<any[]> = new EventEmitter<any[]>();\r\n    @Output() onShow:EventEmitter<any[]> = new EventEmitter<any[]>();\r\n    @Output() onClear:EventEmitter<any[]> = new EventEmitter<any[]>();\r\n\r\n    rows:any[] =[];\r\n    _options:any[] = [];\r\n    isOpen:boolean;\r\n    filter:string;\r\n    filteredData:any[] = [];\r\n    _selectedValues:any[] =[];\r\n    get selectedValues():any[]{\r\n        return this._selectedValues;\r\n    };\r\n\r\n    set selectedValues(val:any[]){\r\n        if(!val) val =[];\r\n\r\n        if(!Array.isArray(val))\r\n            val = [val];\r\n\r\n        this._selectedValues = val;\r\n    }\r\n\r\n    constructor(private element:ElementRef,\r\n                private renderer: Renderer) {\r\n    }\r\n\r\n    /**\r\n     * on click outside the view close the menu\r\n     * @param event\r\n     */\r\n    onDocumentClick(event) {\r\n        if (this.isOpen && !this.element.nativeElement.contains(event.target))\r\n            this.hide();\r\n    }\r\n\r\n    updateRows(val:any[] =[]){\r\n        this.rows = val;\r\n    }\r\n\r\n    updateFilter(filter){\r\n        const lowercaseFilter = filter.toLocaleLowerCase();\r\n        this.filteredData = this._options.filter(item =>\r\n        !lowercaseFilter || (item.name || item).toLowerCase().indexOf(lowercaseFilter) !== -1);\r\n        this.updateRows(this.filteredData);\r\n    }\r\n\r\n    clearFilter(){\r\n        if(this.filter === \"\") return;\r\n\r\n        this.filter = \"\";\r\n        this.updateFilter(this.filter);\r\n    }\r\n\r\n    toggleSelected(item){\r\n        if(!item) return;\r\n        this.clearFilter();\r\n\r\n        if(this.isMultiselect)\r\n            this.selectMultiple(item);\r\n        else{\r\n            this.selectSingle(item)\r\n        }\r\n\r\n        this.propagateChange(this._selectedValues);\r\n    }\r\n\r\n    selectSingle(item){\r\n        this._selectedValues.splice(0, this.rows.length);\r\n        this._selectedValues.push(item);\r\n        this.hide();\r\n    }\r\n\r\n    selectMultiple(item){\r\n        if(this.selectedValues.indexOf(item) == -1){\r\n            this.selectedValues.push(item);\r\n        }\r\n        else{\r\n            this.selectedValues.splice(this.selectedValues.indexOf(item),1);\r\n        }\r\n    }\r\n\r\n    focusFilter(){\r\n        setTimeout(()=>{\r\n            this.renderer.invokeElementMethod(this.inputFilter.nativeElement, 'focus');\r\n        },0);\r\n    }\r\n\r\n    show(){\r\n        if(this.isOpen || this.disabled) return;\r\n\r\n        this.isOpen = true;\r\n        this.focusFilter();\r\n        this.onShow.emit();\r\n    }\r\n\r\n    hide(){\r\n        this.isOpen = false;\r\n        this.clearFilter();\r\n        this.onHide.emit();\r\n    }\r\n\r\n    clear(){\r\n        if(this.disabled) return;\r\n\r\n        this.selectedValues = [];\r\n        this.propagateChange(this._selectedValues);\r\n        this.onClear.emit();\r\n    }\r\n\r\n    ngOnInit() {\r\n    }\r\n\r\n    //////// ControlValueAccessor imp //////////\r\n\r\n    writeValue(value: any) {\r\n        this.selectedValues = value;\r\n    }\r\n\r\n    propagateChange = (_: any) => {};\r\n\r\n    registerOnChange(fn) {\r\n        this.propagateChange = fn;\r\n    }\r\n\r\n    registerOnTouched() {}\r\n}\r\n\r\nexport function ShSelectProvider():any{\r\n    return forwardRef(() =>ShSelectComponent);\r\n}\r\n\ninterface DecoratorInvocation {\n  type: Function;\n  args?: any[];\n}\n"]}